<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="wheelSpinner">
        <p data-value="1">Test 1</p>
        <p data-value="2">Test 2</p>
        <p data-value="3">Test 3</p>
        <p data-value="4">Test 4</p>
        <p data-value="5">Test 5</p>
        <p data-value="6">Test 6</p>
        <p data-value="7">Test 7</p>
        <p data-value="8">Test 8</p>
        <p data-value="9">Test 9</p>
        <p data-value="10">Test 10</p>
    </div>

    <button type="button" onclick="roll()">click</button>
    <script>
        let color = ['AliceBlue', 'AntiqueWhite', 'Aqua', 'Aquamarine', 'Azure', 'Beige', 'Bisque', 'BlueViolet', 'HotPink', 'DeepPink']

        class WheelSpinner{
            id = null;
            options = null;

            contentTotal = null;
            contentStyle = '';
            rotation = 1024;

            constructor(id, options) {
                if (id == null) return console.error("[WheelSpinner.js] missing 'id' parameter.");
                if (options == null) return console.error("[WheelSpinner.js] missing 'options' parameter.");

                this.id = id;
                this.options = options;

                this.setDefault();
                this.drawContent();
                this.injectStyle();
            }

            setDefault() {
                if (this.options['size'] == null) this.options['size'] = 600;


            }

            drawContent() {
                let element = document.getElementById(this.id);
                let contentElements = [].slice.call(element.children);

                this.contentTotal = contentElements.length;

                if (this.contentTotal < 1) return;

                element.innerHTML = '';
                for (let i = 0; i < this.contentTotal; i++) {
                    let content = document.createElement("div");

                    let degrees = 360/this.contentTotal;
                    let tangent = Math.tan((degrees /2) * Math.PI / 180)
                    let base = (2 * (this.options['size']/2)) * tangent;
                    let length = (this.options['size'] - base) / this.options['size'] * 100;

                    content.appendChild(contentElements[i]);
                    content.firstChild.style.transform = `translateY(-50px) rotate(${360 - ((360/this.contentTotal) * (i+1))}deg) `;
                    element.appendChild(content);

                    this.contentStyle += ` #${this.id}>:nth-child(${i+1}) {
                                            clip-path: polygon(50% 100%, ${100 - length}% 0, ${(length)}% 0);
                                            transform: rotate(${(360/this.contentTotal) * (i+1)}deg);
                                            transform-origin: 50% 100%;
                                            background-color: ${color[i]};
                                        }
                                        `;
                }
            }

            injectStyle() {
                let head = document.getElementsByTagName('head')[0];
                let style = document.createElement('style');

                style.innerHTML = ` #${this.id} {
                                        border: 1px solid blue;
                                        border-radius: 50%;
                                        overflow: hidden;
                                        position: relative;
                                        transition: transform ease ${this.options['duration']}ms;
                                        height: ${this.options['size']}px;
                                        width: ${this.options['size']}px;
                                    }

                                    #${this.id} * {
                                        display: flex;
                                        justify-content: center;
                                        align-items: center;
                                        position: absolute;
                                        top: 0px;
                                        left: 0px;
                                        height: ${this.options['size']/2}px;
                                        width: ${this.options['size']}px;
                                    }
                                    
                                    ` 
                                    + this.contentStyle;
                head.appendChild(style);
            }

            spin(value) {
                let rotate
                this.rotation += 1024;

                document.getElementById(this.id).style.transform = `rotate(${this.rotation}deg)`;
            }
        }

        let options = {
            audio: false,
            background: {
                color: null,
                image: null,
            },
            border: {
                color: null,
                size: 2,
            },
            // size: 500,
            duration: 4000,
        }

        let wheelSpinner = new WheelSpinner('wheelSpinner', options);

        function roll() {
            wheelSpinner.spin();
        }
    </script>
</body>
</html>